{% extends 'products/base.html' %}
{% block content %}
<div class="check">
      <h2>Your Cart</h2>
      <form method="post" action="{% url 'update_cart' %}">{% csrf_token %}
    <div class="qty">
      <table>
        <thead><tr><th>Product</th><th>Qty</th><th>Line</th><th></th></tr></thead>
        <tbody>
          {% for it in items %}
          <tr>
            <td>{{ it.product.name }}</td>
            <td><input name="qty_{{ it.product.id }}" value="{{ it.quantity }}" min="0"></td>
            <td>Ksh {{ it.line_total }}</td>
            <td><a href="{% url 'remove_from_cart' it.product.id %}">Remove</a></td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
      <button type="submit">Update cart</button>
      </form>
      <p>Total: Ksh {{ total }}</p>

      {% if items %}
      <form method="post" action="{% url 'checkout' %}">{% csrf_token %}
        <!-- Simple payment choice -->
        <label>Payment method:
          <select name="payment_method">
            <option value="paystack">Paystack</option>
            <option value="stripe">Stripe</option>
          </select>
        </label>
        <button type="submit" class="submit">Checkout</button>
      </form>
</div>
      {% else %}
      <p>Your cart is empty.</p>
      {% endif %}
    {% endblock %}